(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function C(e){const t=document.getElementById("game-board");t.innerHTML="";for(let n=0;n<25;n++){const r=document.createElement("div");r.classList.add("cell"),r.addEventListener("click",()=>e(n)),t.appendChild(r)}}function L(e){document.querySelectorAll(".cell").forEach((n,r)=>{n.textContent=e[r],n.className="cell",e[r]==="X"&&n.classList.add("player-x"),e[r]==="O"&&n.classList.add("player-o"),e[r]==="N"&&n.classList.add("player-n")})}function _(e){const t=[[0,1,2,3],[1,2,3,4],[5,6,7,8],[6,7,8,9],[10,11,12,13],[11,12,13,14],[15,16,17,18],[16,17,18,19],[20,21,22,23],[21,22,23,24],[0,5,10,15],[1,6,11,16],[2,7,12,17],[3,8,13,18],[4,9,14,19],[5,10,15,20],[6,11,16,21],[7,12,17,22],[8,13,18,23],[9,14,19,24],[0,6,12,18],[1,7,13,19],[3,7,11,15],[4,8,12,16],[5,11,17,23],[6,12,18,24],[8,12,16,20],[9,13,17,21]];for(const n of t){const[r,s,o,c]=n;if(e[r]&&e[r]===e[s]&&e[r]===e[o]&&e[r]===e[c])return{winner:e[r],pattern:n}}for(let n=0;n<4;n++)for(let r=0;r<4;r++){const s=n*5+r;if(e[s]&&e[s]===e[s+1]&&e[s]===e[s+5]&&e[s]===e[s+6])return{winner:e[s],pattern:[s,s+1,s+5,s+6]}}return e.every(n=>n!=="")?{winner:"draw",pattern:null}:{winner:null,pattern:null}}function X(e,t,n,r){let s;switch(n){case"easy":s=p(e);break;case"medium":s=Math.random()<.5?p(e):S(e,t);break;case"hard":s=S(e,t);break;default:s=p(e)}s!==void 0&&r(s)}function p(e){const t=e.reduce((n,r,s)=>(r===""&&n.push(s),n),[]);return t[Math.floor(Math.random()*t.length)]}function S(e,t){const n=k(e,t);if(n!==-1)return n;const r=["X","O","N"].filter(i=>i!==t);for(let i of r){const y=k(e,i);if(y!==-1)return y}const s=M(e,t);if(s!==-1)return s;for(let i of r){const y=M(e,i);if(y!==-1)return y}const o=G(e,t);if(o!==-1)return o;const c=[0,4,20,24,12];for(let i of c)if(e[i]==="")return i;return p(e)}function k(e,t){for(let n=0;n<e.length;n++)if(e[n]===""){const r=[...e];if(r[n]=t,_(r).winner===t)return n}return-1}function M(e,t){for(let n=0;n<e.length;n++)if(e[n]===""){const r=[...e];r[n]=t;let s=0;for(let o=0;o<e.length;o++)if(r[o]===""){const c=[...r];c[o]=t,_(c).winner===t&&s++}if(s>=2)return n}return-1}function G(e,t){const n=[[0,1,2,3],[1,2,3,4],[5,6,7,8],[6,7,8,9],[10,11,12,13],[11,12,13,14],[15,16,17,18],[16,17,18,19],[20,21,22,23],[21,22,23,24],[0,5,10,15],[5,10,15,20],[1,6,11,16],[6,11,16,21],[2,7,12,17],[7,12,17,22],[3,8,13,18],[8,13,18,23],[4,9,14,19],[9,14,19,24],[0,6,12,18],[6,12,18,24],[4,8,12,16],[8,12,16,20],[0,1,5,6],[1,2,6,7],[2,3,7,8],[3,4,8,9],[5,6,10,11],[6,7,11,12],[7,8,12,13],[8,9,13,14],[10,11,15,16],[11,12,16,17],[12,13,17,18],[13,14,18,19],[15,16,20,21],[16,17,21,22],[17,18,22,23],[18,19,23,24]];for(let r of n){const s=r.filter(i=>e[i]===""),o=r.filter(i=>e[i]===t),c=r.filter(i=>e[i]!==""&&e[i]!==t);if(s.length===2&&o.length===2&&c.length===0)return s[0]}return-1}function a(e,t="Game",n="",r=null){if(typeof gtag<"u"){const s={event_category:t,event_label:n};r!==null&&(s.value=r),gtag("event",e,s)}}function A(e,t){a("game_start","Game",`${e}_games_${t}`)}function P(e,t){a("game_end","Game",`winner_${e}`,t)}function q(e,t,n,r,s){a("series_end","Series",`winner_${e}`,t),a("series_stats","Series","player_wins",n),a("series_stats","Series","blocker_wins",r),a("series_stats","Series","hunter_wins",s)}function T(e,t,n){a("move_made","Gameplay",`player_${e}_cell_${t}`,n)}function W(e){a("modal_open","UI",e)}function g(e){a("button_click","UI",e)}function j(e,t){a("series_abandoned","Game",`game_${e}_of_${t}`)}let f="X",B="medium",m=Array(25).fill(""),l={X:0,O:0,N:0},u=1,d=10,v=0;document.addEventListener("DOMContentLoaded",()=>{document.getElementById("start-series").addEventListener("click",F),document.getElementById("new-game").addEventListener("click",()=>{g("new_game"),E()}),document.getElementById("new-series").addEventListener("click",()=>{g("new_series"),h()}),document.getElementById("close-stats").addEventListener("click",z),document.getElementById("help-button").addEventListener("click",J),document.getElementById("close-rules").addEventListener("click",Q),document.getElementById("abandon-series").addEventListener("click",V),C($),h()});function h(){document.getElementById("setup-screen").style.display="flex",document.getElementById("game-screen").style.display="none"}function D(){document.getElementById("setup-screen").style.display="none",document.getElementById("game-screen").style.display="flex"}function F(){d=parseInt(document.getElementById("series-length").value),B=document.getElementById("difficulty").value,l={X:0,O:0,N:0},u=1,A(d,B),g("start_series"),O(),E(),document.getElementById("series-stats").style.display="none";const e=document.getElementById("player-name"),t=document.querySelector("#player-progress .player-name");e&&t&&(t.textContent=e.value||"Player"),D(),N()}function E(){m=Array(25).fill(""),f="X",v=0,L(m),document.getElementById("status").textContent="",N(),document.querySelectorAll(".cell").forEach(t=>{t.classList.remove("winning-cell")})}function N(){document.getElementById("game-progress").textContent=`Game ${u} of ${d}`}function O(){w("player-progress",l.X),w("blocker-progress",l.O),w("hunter-progress",l.N)}function w(e,t){const n=document.querySelector(`#${e} .progress`),r=document.querySelector(`#${e} .progress-text`);if(n&&r){const s=t/d*100;n.style.width=`${s}%`,r.textContent=t.toString()}else console.error(`Progress bar not found: ${e}`)}function $(e){if(!(u>d))if(m[e]===""){v++,m[e]=f,L(m),T(f,e,v);const{winner:t,pattern:n}=_(m);t?H(t,n):(f=K(f),f!=="X"&&X(m,f,B,$))}else console.log("This cell is already occupied or the game has ended. Please start a new game.")}function H(e,t){e==="draw"?R():(l[e]+=1,P(e,u),O(),document.getElementById("status").textContent=`${I(e)} wins!`,U(t),setTimeout(()=>{u>=d?x():(u++,E())},3e3))}function R(){P("draw",u),document.getElementById("status").textContent="It's a draw!",setTimeout(()=>{u>=d?x():(u++,E())},3e3)}function U(e){if(e){const t=document.querySelectorAll(".cell");e.forEach(n=>{t[n]&&t[n].classList.add("winning-cell")})}}function x(){const e=Math.max(l.X,l.O,l.N),t=Object.keys(l).filter(r=>l[r]===e),n=t.length>1?"draw":t[0];q(n,d,l.X,l.O,l.N),document.getElementById("series-stats").style.display="flex",t.length>1?document.getElementById("series-winner").textContent="Series Result: It's a draw!":document.getElementById("series-winner").textContent=`Series Winner: ${I(n)}`,document.getElementById("player-wins").textContent=`${I("X")} wins: ${l.X}`,document.getElementById("blocker-wins").textContent=`Blocker wins: ${l.O}`,document.getElementById("hunter-wins").textContent=`Hunter wins: ${l.N}`}function z(){g("close_stats"),document.getElementById("series-stats").style.display="none",h()}function I(e){if(e==="X")return document.getElementById("player-name").value||"Player";if(e==="O")return"Blocker";if(e==="N")return"Hunter"}function K(e){const t=["X","O","N"],n=t.indexOf(e);return t[(n+1)%t.length]}function J(){W("rules"),g("help_button");const e=document.getElementById("rules-modal");e.style.display="flex"}function Q(){g("close_rules");const e=document.getElementById("rules-modal");e.style.display="none"}function V(){j(u,d),g("abandon_series"),alert("Series abandoned."),h()}
